


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Android Quickstart &mdash; PyTorch Mobile .0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
                  <span class="dropdown-title">TorchElastic</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorch’s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">PyTorch Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploymentWorkflow.html">Deployment workflow</a></li>
</ul>
<p class="caption"><span class="caption-text">Quickstart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstarts/androidquickstart.html">Android Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstarts/iosquickstart.html">iOS Quickstart</a></li>
</ul>
<p class="caption"><span class="caption-text">Build From Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="androidsourcebuild.html">Building PyTorch Android from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="iossourcebuild.html">Building PyTorch iOS from Source</a></li>
</ul>
<p class="caption"><span class="caption-text">Binary Size Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="selectivebuild/andriodSelectiveBuild.html">Andriod Selective Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="selectivebuild/iosSelectiveBuild.html">iOS Selective Build</a></li>
</ul>
<p class="caption"><span class="caption-text">Using PyTorch Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="usinglibraries/usingAndroidLibraries.html">Using the PyTorch Android Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="usinglibraries/usingiosLibraries.html">Using the PyTorch iOS Libraries</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Preparation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modelprep/quantization.html">Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelprep/scriptOptimizeMobile.html">Script and Optimize for Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="modelprep/liteJitInterpreters.html">Lite and Full Jit Interpreters</a></li>
</ul>
<p class="caption"><span class="caption-text">Performance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance/bestPractices.html">Pytorch Mobile Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance/fuseModules.html">Fuse Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance/andriodBenchmark.html">Andriod Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance/iosBenchmark.html">iOS Benchmarking</a></li>
</ul>
<p class="caption"><span class="caption-text">Backends</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backends/GPUandroid.html">Using GPU on Andriod (Vulkan Backend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="backends/GPUiOS.html">Using GPU on iOS (Metal Backend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="backends/NNAPIandroid.html">Convert MobileNetV2 to NNAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="backends/coreMLios.html">Core ML on iOS</a></li>
</ul>
<p class="caption"><span class="caption-text">Custom Operators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="customOperators.html">Andriod Native Application with Custom Operators</a></li>
</ul>
<p class="caption"><span class="caption-text">Run Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="runInference.html">Operator Compatibility</a></li>
</ul>
<p class="caption"><span class="caption-text">Video Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="videos/runtimeAndroid.html">PyTorch Mobile Runtime for Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="videos/runtimeiOS.html">PyTorch Mobile Runtime for iOS</a></li>
</ul>
<p class="caption"><span class="caption-text">Android Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidD2Go.html">Android D2Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidImageSegmentation.html">Image Segmentation DeepLabV3 on Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidObjectDetection.html">Android Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidNeuralMachineTranslation.html">Android Neural Machine Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidQuestionAnswering.html">Android Question Answering</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidVisionTransformer.html">Android Vision Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidSpeechRecognition.html">Android Speech Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="androidTutorials/androidVideoClassification.html">Android Video Classification</a></li>
</ul>
<p class="caption"><span class="caption-text">iOS Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosD2Go.html">iOS D2Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosImageSegmentation.html">Image Segmentation DeepLabV3 on iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosObjectDetection.html">iOS Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosNeuralMachineTranslation.html">iOS Neural Machine Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosQuestionAnswering.html">iOS Question Answering</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosVisionTransformer.html">iOS Vision Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosSpeechRecognition.html">iOS Speech Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="iosTutorials/iosVideoClassification.html">iOS Video Classification</a></li>
</ul>
<p class="caption"><span class="caption-text">API Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">Mobile API Docs</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="contents.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Android Quickstart</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/quickstart.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="android-quickstart">
<h1>Android Quickstart<a class="headerlink" href="#android-quickstart" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/pytorch/android-demo-app/tree/master/HelloWorldApp">HelloWorld</a>
is a simple image classification application that demonstrates how to
use PyTorch Android API. This application runs TorchScript serialized
TorchVision pretrained resnet18 model on static image which is packaged
inside the app as android asset.</p>
<div class="section" id="model-preparation">
<h2>1. Model Preparation<a class="headerlink" href="#model-preparation" title="Permalink to this headline">¶</a></h2>
<p>Let’s start with model preparation. If you are familiar with PyTorch,
you probably should already know how to train and save your model. In
case you don’t, we are going to use a pre-trained image classification
model
(<a class="reference external" href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNetV2</a>).
To install it, run the command below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">torchvision</span>
</pre></div>
</div>
<p>To serialize the model you can use python
<a class="reference external" href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/trace_model.py">script</a>
in the root folder of HelloWorld app:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">from</span> <span class="nn">torch.utils.mobile_optimizer</span> <span class="k">import</span> <span class="n">optimize_for_mobile</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">mobilenet_v2</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">example</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
<span class="n">traced_script_module</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">example</span><span class="p">)</span>
<span class="n">traced_script_module_optimized</span> <span class="o">=</span> <span class="n">optimize_for_mobile</span><span class="p">(</span><span class="n">traced_script_module</span><span class="p">)</span>
<span class="n">traced_script_module_optimized</span><span class="o">.</span><span class="n">_save_for_lite_interpreter</span><span class="p">(</span><span class="s2">&quot;app/src/main/assets/model.ptl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If everything works well, we should have our model - <code class="docutils literal notranslate"><span class="pre">model.ptl</span></code>
generated in the assets folder of android application. That will be
packaged inside android application as <code class="docutils literal notranslate"><span class="pre">asset</span></code> and can be used on the
device.</p>
<p>More details about TorchScript you can find in <a class="reference external" href="https://pytorch.org/docs/stable/jit.html">tutorials on
pytorch.org</a></p>
</div>
<div class="section" id="cloning-from-github">
<h2>2. Cloning from github<a class="headerlink" href="#cloning-from-github" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pytorch</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">demo</span><span class="o">-</span><span class="n">app</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">HelloWorldApp</span>
</pre></div>
</div>
<p>If <a class="reference external" href="https://developer.android.com/studio/index.html#command-tools">Android
SDK</a>
and <a class="reference external" href="https://developer.android.com/ndk/downloads">Android NDK</a> are
already installed you can install this application to the connected
android device or emulator with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">gradlew</span> <span class="n">installDebug</span>
</pre></div>
</div>
<p>We recommend you to open this project in <a class="reference external" href="https://developer.android.com/studio">Android Studio
3.5.1+</a>. At the moment PyTorch
Android and demo applications use <a class="reference external" href="https://developer.android.com/studio/releases/gradle-plugin#3-5-0">android gradle plugin of version
3.5.0</a>,
which is supported only by Android Studio version 3.5.1 and higher.
Using Android Studio you will be able to install Android NDK and Android
SDK with Android Studio UI.</p>
</div>
<div class="section" id="gradle-dependencies">
<h2>3. Gradle dependencies<a class="headerlink" href="#gradle-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Pytorch android is added to the HelloWorld as <a class="reference external" href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/build.gradle#L28-L29">gradle
dependencies</a>
in build.gradle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repositories</span> <span class="p">{</span>
    <span class="n">jcenter</span><span class="p">()</span>
<span class="p">}</span>

<span class="n">dependencies</span> <span class="p">{</span>
    <span class="n">implementation</span> <span class="s1">&#39;org.pytorch:pytorch_android_lite:1.9.0&#39;</span>
    <span class="n">implementation</span> <span class="s1">&#39;org.pytorch:pytorch_android_torchvision:1.9.0&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">org.pytorch:pytorch_android</span></code> is the main dependency with
PyTorch Android API, including libtorch native library for all 4 android
abis (armeabi-v7a, arm64-v8a, x86, x86_64). Further in this doc you can
find how to rebuild it only for specific list of android abis.</p>
<p><code class="docutils literal notranslate"><span class="pre">org.pytorch:pytorch_android_torchvision</span></code> - additional library with
utility functions for converting <code class="docutils literal notranslate"><span class="pre">android.media.Image</span></code> and
<code class="docutils literal notranslate"><span class="pre">android.graphics.Bitmap</span></code> to tensors.</p>
</div>
<div class="section" id="reading-image-from-android-asset">
<h2>4. Reading image from Android Asset<a class="headerlink" href="#reading-image-from-android-asset" title="Permalink to this headline">¶</a></h2>
<p>All the logic happens in
<code class="docutils literal notranslate"><span class="pre">`org.pytorch.helloworld.MainActivity</span></code> &lt;<a class="reference external" href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/src/main/java/org/pytorch/helloworld/MainActivity.java#L31-L69">https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/src/main/java/org/pytorch/helloworld/MainActivity.java#L31-L69</a>&gt;`__.
As a first step we read <code class="docutils literal notranslate"><span class="pre">image.jpg</span></code> to <code class="docutils literal notranslate"><span class="pre">android.graphics.Bitmap</span></code>
using the standard Android API.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Bitmap</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="n">decodeStream</span><span class="p">(</span><span class="n">getAssets</span><span class="p">()</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;image.jpg&quot;</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-mobile-module">
<h2>5. Loading Mobile Module<a class="headerlink" href="#loading-mobile-module" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Module</span> <span class="n">module</span> <span class="o">=</span> <span class="n">Module</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">assetFilePath</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="s2">&quot;model.ptl&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">org.pytorch.Module</span></code> represents <code class="docutils literal notranslate"><span class="pre">torch::jit::mobile::Module</span></code> that
can be loaded with <code class="docutils literal notranslate"><span class="pre">load</span></code> method specifying file path to the
serialized to file model.</p>
</div>
<div class="section" id="preparing-input">
<h2>6. Preparing Input<a class="headerlink" href="#preparing-input" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tensor</span> <span class="n">inputTensor</span> <span class="o">=</span> <span class="n">TensorImageUtils</span><span class="o">.</span><span class="n">bitmapToFloat32Tensor</span><span class="p">(</span><span class="n">bitmap</span><span class="p">,</span>
    <span class="n">TensorImageUtils</span><span class="o">.</span><span class="n">TORCHVISION_NORM_MEAN_RGB</span><span class="p">,</span> <span class="n">TensorImageUtils</span><span class="o">.</span><span class="n">TORCHVISION_NORM_STD_RGB</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">org.pytorch.torchvision.TensorImageUtils</span></code> is part of
<code class="docutils literal notranslate"><span class="pre">org.pytorch:pytorch_android_torchvision</span></code> library. The
<code class="docutils literal notranslate"><span class="pre">TensorImageUtils#bitmapToFloat32Tensor</span></code> method creates tensors in the
<a class="reference external" href="https://pytorch.org/docs/stable/torchvision/models.html">torchvision
format</a>
using <code class="docutils literal notranslate"><span class="pre">android.graphics.Bitmap</span></code> as a source.</p>
<blockquote>
<div>All pre-trained models expect input images normalized in the same
way, i.e. mini-batches of 3-channel RGB images of shape (3 x H x W),
where H and W are expected to be at least 224. The images have to be
loaded in to a range of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code> and then normalized using
<code class="docutils literal notranslate"><span class="pre">mean</span> <span class="pre">=</span> <span class="pre">[0.485,</span> <span class="pre">0.456,</span> <span class="pre">0.406]</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">=</span> <span class="pre">[0.229,</span> <span class="pre">0.224,</span> <span class="pre">0.225]</span></code></div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">inputTensor</span></code>’s shape is <code class="docutils literal notranslate"><span class="pre">1x3xHxW</span></code>, where <code class="docutils literal notranslate"><span class="pre">H</span></code> and <code class="docutils literal notranslate"><span class="pre">W</span></code> are
bitmap height and width appropriately.</p>
</div>
<div class="section" id="run-inference">
<h2>7. Run Inference<a class="headerlink" href="#run-inference" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tensor</span> <span class="n">outputTensor</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">IValue</span><span class="o">.</span><span class="n">from</span><span class="p">(</span><span class="n">inputTensor</span><span class="p">))</span><span class="o">.</span><span class="n">toTensor</span><span class="p">();</span>
<span class="nb">float</span><span class="p">[]</span> <span class="n">scores</span> <span class="o">=</span> <span class="n">outputTensor</span><span class="o">.</span><span class="n">getDataAsFloatArray</span><span class="p">();</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">org.pytorch.Module.forward</span></code> method runs loaded module’s <code class="docutils literal notranslate"><span class="pre">forward</span></code>
method and gets result as <code class="docutils literal notranslate"><span class="pre">org.pytorch.Tensor</span></code> outputTensor with shape
<code class="docutils literal notranslate"><span class="pre">1x1000</span></code>.</p>
</div>
<div class="section" id="processing-results">
<h2>8. Processing results<a class="headerlink" href="#processing-results" title="Permalink to this headline">¶</a></h2>
<p>Its content is retrieved using
<code class="docutils literal notranslate"><span class="pre">org.pytorch.Tensor.getDataAsFloatArray()</span></code> method that returns java
array of floats with scores for every image net class.</p>
<p>After that we just find index with maximum score and retrieve predicted
class name from <code class="docutils literal notranslate"><span class="pre">ImageNetClasses.IMAGENET_CLASSES</span></code> array that contains
all ImageNet classes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="nb">float</span> <span class="n">maxScore</span> <span class="o">=</span> <span class="o">-</span><span class="n">Float</span><span class="o">.</span><span class="n">MAX_VALUE</span><span class="p">;</span>
 <span class="nb">int</span> <span class="n">maxScoreIdx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
 <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">scores</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">maxScore</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">maxScore</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
     <span class="n">maxScoreIdx</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
   <span class="p">}</span>
 <span class="p">}</span>
 <span class="n">String</span> <span class="n">className</span> <span class="o">=</span> <span class="n">ImageNetClasses</span><span class="o">.</span><span class="n">IMAGENET_CLASSES</span><span class="p">[</span><span class="n">maxScoreIdx</span><span class="p">];</span>


<span class="n">iOS</span> <span class="n">Quickstart</span>
</pre></div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="https://github.com/pytorch/ios-demo-app/tree/master/HelloWorld">HelloWorld</a> for IOS is a simple image classification application that
demonstrates how to use PyTorch C++ libraries on iOS. The code is
written in Swift and uses Objective-C as a bridge.</p>
<div class="section" id="id1">
<h3>Model Preparation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Let’s start with model preparation. If you are familiar with PyTorch,
you probably should already know how to train and save your model. In
case you don’t, we are going to use a pre-trained image classification
model - <a class="reference external" href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNet
v2</a>, which is
already packaged in
<a class="reference external" href="https://pytorch.org/docs/stable/torchvision/index.html">TorchVision</a>.
To install it, run the command below.</p>
<blockquote>
<div>We highly recommend following the <a class="reference external" href="https://github.com/pytorch/pytorch">Pytorch Github
page</a> to set up the Python
development environment on your local machine.</div></blockquote>
<div class="code shell highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">torchvision</span>
</pre></div>
</div>
<p>Once we have TorchVision installed successfully, let’s navigate to the
HelloWorld folder and run <code class="docutils literal notranslate"><span class="pre">trace_model.py</span></code>. The script contains the
code of tracing and saving a <a class="reference external" href="https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html">torchscript
model</a>
that can be run on mobile devices.</p>
<div class="code shell highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">trace_model</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>If everything works well, we should have our model - <code class="docutils literal notranslate"><span class="pre">model.pt</span></code>
generated in the <code class="docutils literal notranslate"><span class="pre">HelloWorld</span></code> folder. Now copy the model file to our
application folder <code class="docutils literal notranslate"><span class="pre">HelloWorld/model</span></code>.</p>
<blockquote>
<div>To find out more details about TorchScript, please visit <a class="reference external" href="https://pytorch.org/tutorials/advanced/cpp_export.html">tutorials
on
pytorch.org</a></div></blockquote>
</div>
<div class="section" id="install-libtorch-via-cocoapods">
<h3>Install LibTorch via Cocoapods<a class="headerlink" href="#install-libtorch-via-cocoapods" title="Permalink to this headline">¶</a></h3>
<p>The PyTorch C++ library is available in
<a class="reference external" href="https://cocoapods.org/">Cocoapods</a>, to integrate it to our project,
simply run</p>
<div class="code ruby highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pod</span> <span class="n">install</span>
</pre></div>
</div>
<p>Now it’s time to open the <code class="docutils literal notranslate"><span class="pre">HelloWorld.xcworkspace</span></code> in XCode, select an
iOS simulator and launch it (cmd + R). If everything works well, we
should see a wolf picture on the simulator screen along with the
prediction result.</p>
</div>
<div class="section" id="code-walkthrough">
<h3>Code Walkthrough<a class="headerlink" href="#code-walkthrough" title="Permalink to this headline">¶</a></h3>
<p>In this part, we are going to walk through the code step by step.</p>
</div>
</div>
<div class="section" id="image-loading">
<h2>Image Loading<a class="headerlink" href="#image-loading" title="Permalink to this headline">¶</a></h2>
<p>Let’s begin with image loading.</p>
<div class="code swift highlight-default notranslate"><div class="highlight"><pre><span></span>let image = UIImage(named: &quot;image.jpg&quot;)!
imageView.image = image
let resizedImage = image.resized(to: CGSize(width: 224, height: 224))
guard var pixelBuffer = resizedImage.normalized() else {
    return
}
</pre></div>
</div>
<p>We first load the image from our bundle and resize it to 224x224. Then
we call this <code class="docutils literal notranslate"><span class="pre">normalized()</span></code> category method to normalized the pixel
buffer. Let’s take a closer look at the code below.</p>
<div class="code swift highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">normalizedBuffer</span><span class="p">:</span> <span class="p">[</span><span class="n">Float32</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Float32</span><span class="p">](</span><span class="n">repeating</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">:</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">//</span> <span class="n">normalize</span> <span class="n">the</span> <span class="n">pixel</span> <span class="n">buffer</span>
<span class="o">//</span> <span class="n">see</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pytorch</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">hub</span><span class="o">/</span><span class="n">pytorch_vision_resnet</span><span class="o">/</span> <span class="k">for</span> <span class="n">more</span> <span class="n">detail</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="mi">0</span> <span class="o">..&lt;</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="p">{</span>
    <span class="n">normalizedBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>             <span class="o">=</span> <span class="p">(</span><span class="n">Float32</span><span class="p">(</span><span class="n">rawBytes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="o">-</span> <span class="mf">0.485</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.229</span> <span class="o">//</span> <span class="n">R</span>
    <span class="n">normalizedBuffer</span><span class="p">[</span><span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>     <span class="o">=</span> <span class="p">(</span><span class="n">Float32</span><span class="p">(</span><span class="n">rawBytes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="o">-</span> <span class="mf">0.456</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.224</span> <span class="o">//</span> <span class="n">G</span>
    <span class="n">normalizedBuffer</span><span class="p">[</span><span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Float32</span><span class="p">(</span><span class="n">rawBytes</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="o">-</span> <span class="mf">0.406</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.225</span> <span class="o">//</span> <span class="n">B</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code might look weird at first glance, but it’ll make sense once we
understand our model. The input data is a 3-channel RGB image of shape
(3 x H x W), where H and W are expected to be at least 224. The image
has to be loaded in to a range of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code> and then normalized using
<code class="docutils literal notranslate"><span class="pre">mean</span> <span class="pre">=</span> <span class="pre">[0.485,</span> <span class="pre">0.456,</span> <span class="pre">0.406]</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">=</span> <span class="pre">[0.229,</span> <span class="pre">0.224,</span> <span class="pre">0.225]</span></code>.</p>
</div>
<div class="section" id="torchscript-module">
<h2>TorchScript Module<a class="headerlink" href="#torchscript-module" title="Permalink to this headline">¶</a></h2>
<p>Now that we have preprocessed our input data and we have a pre-trained
TorchScript model, the next step is to use them to run predication. To
do that, we’ll first load our model into the application.</p>
<div class="code swift highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">private</span> <span class="n">lazy</span> <span class="n">var</span> <span class="n">module</span><span class="p">:</span> <span class="n">TorchModule</span> <span class="o">=</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">let</span> <span class="n">filePath</span> <span class="o">=</span> <span class="n">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">path</span><span class="p">(</span><span class="n">forResource</span><span class="p">:</span> <span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">ofType</span><span class="p">:</span> <span class="s2">&quot;pt&quot;</span><span class="p">),</span>
        <span class="n">let</span> <span class="n">module</span> <span class="o">=</span> <span class="n">TorchModule</span><span class="p">(</span><span class="n">fileAtPath</span><span class="p">:</span> <span class="n">filePath</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">module</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">fatalError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t find the model file!&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}()</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">TorchModule</span></code> Class is an Objective-C wrapper of
<code class="docutils literal notranslate"><span class="pre">torch::jit::mobile::Module</span></code>.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="p">::</span><span class="n">jit</span><span class="p">::</span><span class="n">mobile</span><span class="p">::</span><span class="n">Module</span> <span class="n">module</span> <span class="o">=</span> <span class="n">torch</span><span class="p">::</span><span class="n">jit</span><span class="p">::</span><span class="n">_load_for_mobile</span><span class="p">(</span><span class="n">filePath</span><span class="o">.</span><span class="n">UTF8String</span><span class="p">);</span>
</pre></div>
</div>
<p>Since Swift can not talk to C++ directly, we have to either use an
Objective-C class as a bridge, or create a C wrapper for the C++
library. For demo purpose, we’re going to wrap everything in this
Objective-C class.</p>
</div>
<div class="section" id="id2">
<h2>Run Inference<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Now it’s time to run inference and get the results.</p>
<div class="code swift highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">guard</span> <span class="n">let</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">UnsafeMutableRawPointer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pixelBuffer</span><span class="p">))</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Again, the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method is just an Objective-C wrapper. Under the
hood, it calls the C++ <code class="docutils literal notranslate"><span class="pre">forward</span></code> function. Let’s take a look at how
it’s implemented.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">at</span><span class="p">::</span><span class="n">Tensor</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">::</span><span class="n">from_blob</span><span class="p">(</span><span class="n">imageBuffer</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">},</span> <span class="n">at</span><span class="p">::</span><span class="n">kFloat</span><span class="p">);</span>
<span class="n">torch</span><span class="p">::</span><span class="n">autograd</span><span class="p">::</span><span class="n">AutoGradMode</span> <span class="n">guard</span><span class="p">(</span><span class="n">false</span><span class="p">);</span>
<span class="n">auto</span> <span class="n">outputTensor</span> <span class="o">=</span> <span class="n">_impl</span><span class="o">.</span><span class="n">forward</span><span class="p">({</span><span class="n">tensor</span><span class="p">})</span><span class="o">.</span><span class="n">toTensor</span><span class="p">();</span>
<span class="nb">float</span><span class="o">*</span> <span class="n">floatBuffer</span> <span class="o">=</span> <span class="n">outputTensor</span><span class="o">.</span><span class="n">data_ptr</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>
</div>
<p>The C++ function <code class="docutils literal notranslate"><span class="pre">torch::from_blob</span></code> will create an input tensor from
the pixel buffer. Note that the shape of the tensor is <code class="docutils literal notranslate"><span class="pre">{1,3,224,224}</span></code>
which represents <code class="docutils literal notranslate"><span class="pre">NxCxWxH</span></code> as we discussed in the above section.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="p">::</span><span class="n">autograd</span><span class="p">::</span><span class="n">AutoGradMode</span> <span class="n">guard</span><span class="p">(</span><span class="n">false</span><span class="p">);</span>
<span class="n">at</span><span class="p">::</span><span class="n">AutoNonVariableTypeMode</span> <span class="n">non_var_type_mode</span><span class="p">(</span><span class="n">true</span><span class="p">);</span>
</pre></div>
</div>
<p>The above two lines tells the PyTorch engine to do inference only. This
is because by default, PyTorch has built-in support for doing
auto-differentiation, which is also known as
<a class="reference external" href="https://pytorch.org/docs/stable/notes/autograd.html">autograd</a>.
Since we don’t do training on mobile, we can just disable the autograd
mode.</p>
<p>Finally, we can call this <code class="docutils literal notranslate"><span class="pre">forward</span></code> function to get the output tensor
and convert it to a <code class="docutils literal notranslate"><span class="pre">float</span></code> buffer.</p>
<div class="code cpp highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">outputTensor</span> <span class="o">=</span> <span class="n">_impl</span><span class="o">.</span><span class="n">forward</span><span class="p">({</span><span class="n">tensor</span><span class="p">})</span><span class="o">.</span><span class="n">toTensor</span><span class="p">();</span>
<span class="nb">float</span><span class="o">*</span> <span class="n">floatBuffer</span> <span class="o">=</span> <span class="n">outputTensor</span><span class="o">.</span><span class="n">data_ptr</span><span class="o">&lt;</span><span class="nb">float</span><span class="o">&gt;</span><span class="p">();</span>
</pre></div>
</div>
<div class="section" id="collect-results">
<h3>Collect Results<a class="headerlink" href="#collect-results" title="Permalink to this headline">¶</a></h3>
<p>The output tensor is a one-dimensional float array of shape 1x1000,
where each value represents the confidence that a label is predicted
from the image. The code below sorts the array and retrieves the top
three results.</p>
<div class="code swift highlight-default notranslate"><div class="highlight"><pre><span></span>let zippedResults = zip(labels.indices, outputs)
let sortedResults = zippedResults.sorted { $0.1.floatValue &gt; $1.1.floatValue }.prefix(3)
</pre></div>
</div>
</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Facebook.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Android Quickstart</a><ul>
<li><a class="reference internal" href="#model-preparation">1. Model Preparation</a></li>
<li><a class="reference internal" href="#cloning-from-github">2. Cloning from github</a></li>
<li><a class="reference internal" href="#gradle-dependencies">3. Gradle dependencies</a></li>
<li><a class="reference internal" href="#reading-image-from-android-asset">4. Reading image from Android Asset</a></li>
<li><a class="reference internal" href="#loading-mobile-module">5. Loading Mobile Module</a></li>
<li><a class="reference internal" href="#preparing-input">6. Preparing Input</a></li>
<li><a class="reference internal" href="#run-inference">7. Run Inference</a></li>
<li><a class="reference internal" href="#processing-results">8. Processing results</a><ul>
<li><a class="reference internal" href="#id1">Model Preparation</a></li>
<li><a class="reference internal" href="#install-libtorch-via-cocoapods">Install LibTorch via Cocoapods</a></li>
<li><a class="reference internal" href="#code-walkthrough">Code Walkthrough</a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-loading">Image Loading</a></li>
<li><a class="reference internal" href="#torchscript-module">TorchScript Module</a></li>
<li><a class="reference internal" href="#id2">Run Inference</a><ul>
<li><a class="reference internal" href="#collect-results">Collect Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script type="text/javascript" src="_static/jquery.js"></script>
         <script type="text/javascript" src="_static/underscore.js"></script>
         <script type="text/javascript" src="_static/doctools.js"></script>
         <script type="text/javascript" src="_static/language_data.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #00ff00;
    }
    /* Sidebar */
    .wy-nav-side {
      background: #E73422;
    }
  </style>
  


  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
            <a href="https://www.youtube.com/pytorch" target="_blank" class="youtube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/elastic/">TorchElastic</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>